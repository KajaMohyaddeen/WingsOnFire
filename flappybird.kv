#:import random random
#: import gb gb
#: import math math
#:import FadeTransition  kivy.uix.screenmanager.FadeTransition
<GameManager>:
    canvas.before:
        Rectangle:
            source:'Images/grey.png'
            size:self.size
            pos:self.pos
        
    Screen1:
    Screen2:
        
<magic>:
    source:''
    size_hint:(None,None)
    pos: (self.parent.pos[0],self.parent.pos[1]+self.parent.height+150) if self.parent else (0,0)
        
<Pipe>:
#    canvas.before:
#        Rectangle:
#            size:self.size
#            pos:self.pos
    theme:self.parent.pipe_theme if self.parent else 'grey'
    source: 'Images/pipes/'+self.theme+'pipe.png'
    size_hint:None,None
    width:dp(48)
    keep_ratio:False
    allow_stretch:True  
    
    Image:
#        canvas.before:
#            Rectangle:
#                size:self.size
#                pos:self.pos
        source:'Images/pipes/'+self.parent.theme+'cap.png'
        id:cap
        pos:(self.x,self.y)
        size_hint:None,None
        width:self.parent.width*1.5
        height:dp(20)
        keep_ratio:False
        allow_stretch:True  
#    
#  
#    Label:
#        text:str(self.parent.pos)
#        outline_color:(0,0,0,1)
#        outline_width:5
#        font_size:'8dp'
#        pos:self.parent.center
<Coin>:
    canvas:
        RoundedRectangle:
            source:'Images/coin.png'
            size:self.size
            pos:self.pos
            radius:[50]
        
    size_hint:None,None
    size:dp(15),dp(15)
    pos: (self.parent.x+self.parent.width,self.parent.y+self.parent.height) if self.parent else (0,0)
    
<Bird>:
#    canvas.before:
#        Color:
#            rgba:1,1,1,1
#        Rectangle:
#            size:self.size
#            pos:self.pos
    flag :0
    source:'Images/birds/%s_down.png'%random.choice(['greenbird','rosebird','brownbird'])
#    allow_stretch:True
#    keep_ratio:False
    size_hint:None,None
    size:dp(50),dp(50)
#    keep_ratio:False
#    allow_stretch:True  
    
    
#    Label:
#        text:str(self.parent.pos)
#        pos:self.parent.pos[0],self.parent.pos[1]
#        outline_color:(0,0,0,1)
#        outline_width:5
#        font_size:dp(8)

<Screen1>:
    canvas:
        Rectangle:
            source:'Images/bg/greycity.png'
            size:self.size
            pos:self.pos
    name:'screen1'

        
    FloatLayout:             
        size_hint:1,1
        pos:self.parent.pos
                
        Button:
            canvas.before:
                RoundedRectangle:
                    source:'Images/start.png'
                    size:self.size
                    pos:self.pos
                    radius:[20]
                    
            text:'START'
            size_hint:.35,.1
            font_name:gb.caviar
            font_size:sp(20)
            pos_hint:{'center_x':.5,'center_y':.4}
            #pos:self.parent.center[0]-self.width/2,self.parent.center[1]-self.height/2
            background_normal:''
            background_color:(0,0,0,0)
            outline_width:3
            outline_color:(0,0,0,1)
            on_release:
                root.manager.transition.direction = 'right'
                root.manager.transition = FadeTransition(duration=1)
                app.root.current= 'screen2'
    
<Screen2>:
    
    name:'screen2'
    pipe_theme:'grey'
    distance:0
    points: 0
    v: 850
    c: 3
    
    FloatLayout:
        id:window
        size_hint:1,1
        pos:self.parent.pos
        
        src:'Images/bg/greycity.png'
        
        canvas.before:   
            Rectangle:
                source:self.src
                size:self.size
                pos:self.pos
                
        Widget:
            size_hint:.2,.05
            pos_hint:{'center_x':.8,'center_y':.9}
            canvas.before:
                Rectangle:
                    source:'Images/bg/grey.png'
                    size:self.size
                    pos:self.pos
                Color:
                    rgba: 0, 0, 0, 1
                Line:
                    width: 5
                    rectangle: self.x, self.y, self.width, self.height
                   

        Label:
            text:str(int(root.distance))
            outline_color:(0,0,0,1)
            font_name:gb.bebas
            outline_width:5
          
            
        Label:
#            canvas:
#                RoundedRectangle:
#                    size:self.size
#                    pos:self.pos
#                    radius:[20]
            text:str(root.points)
            outline_color:(0,0,0,1)
            pos_hint:{'center_x':.5,'center_y':.8}
            font_name:random.choice([gb.caviar,gb.bebas,gb.seasrn,gb.wingding,gb.greatvibes])
            outline_width:7
            font_size:sp(50)
          
